var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i};define(["require","exports","../../js/libs/GL/GL","./Views","./Models","./Data","namespace","backbone","namespace","marionette","underscore"],function(n,t,i,r,u,f){var y=n("namespace"),b=n("backbone"),k=n("marionette"),p=n("jquery"),d=n("underscore"),h=i,c=r,l=u,o=f,a=y.app,e=a.module("BookAtHome"),w="http://saqibshakil.github.io/facilities.json?",s,v;e.Rnd==undefined&&(e.Rnd=Math.random()),s=function(n){function t(t){this.Controller=new v,this.routes={"*actions":"home"},n.call(this,t)}return __extends(t,n),t.prototype.beforeRoute=function(){return this.Controller.InitializeLayout(),!0},t}(h.ModuleRouter),t.Router=s,v=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.InitializeLayout=function(){if(this.Layout===undefined||this.Layout.isClosed!=!1){this.Layout=new c.MainView,a.content.show(this.Layout);var n;try{localStorage.getItem("Facilities")!=undefined&&(n=JSON.parse(localStorage.getItem("Facilities"))),console.log("Facilities loaded from localstorage")}catch(t){n=o.Facilities,console.log("Facilities not loaded from localstorage")}o.Facilities=n}},t.prototype.home=function(){var n=this;console.log("Service Called"),p.getJSON(w+e.Rnd*1e3).done(function(t){console.log("Success"),n.Items=new l.Facilities(t.Facilities),localStorage.setItem("Facilities",JSON.stringify(t.Facilities)),console.log("LocalStorage Updated")}).fail(function(){n.Items=new l.Facilities(o.Facilities),console.log("Failure")}).always(function(){var t=new c.GridView({collection:n.Items});n.Layout.detail.show(t),console.log("Rendered")})},t}(h.Controller),e.Router=s})