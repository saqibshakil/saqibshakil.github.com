(function(){function t(){return((1+Math.random())*65536|0).toString(16).substring(1)}function r(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}var i=this._,n=this.Backbone;n.LocalStorage=window.Store=function(n){this.name=n;var t=this.localStorage().getItem(this.name);this.records=t&&t.split(",")||[]},i.extend(n.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(n){return n.id||(n.id=r(),n.set(n.idAttribute,n.id)),this.localStorage().setItem(this.name+"-"+n.id,JSON.stringify(n)),this.records.push(n.id.toString()),this.save(),n.toJSON()},update:function(n){return this.localStorage().setItem(this.name+"-"+n.id,JSON.stringify(n)),i.include(this.records,n.id.toString())||this.records.push(n.id.toString()),this.save(),n.toJSON()},find:function(n){return JSON.parse(this.localStorage().getItem(this.name+"-"+n.id))},findAll:function(){return i(this.records).chain().map(function(n){return JSON.parse(this.localStorage().getItem(this.name+"-"+n))},this).compact().value()},destroy:function(n){return this.localStorage().removeItem(this.name+"-"+n.id),this.records=i.reject(this.records,function(t){return t==n.id.toString()}),this.save(),n},localStorage:function(){return localStorage}}),n.LocalStorage.sync=window.Store.sync=n.localSync=function(n,t,i,r){var f=t.localStorage||t.collection.localStorage,u;typeof i=="function"&&(i={success:i,error:r});switch(n){case"read":u=t.id!=undefined?f.find(t):f.findAll();break;case"create":u=f.create(t);break;case"update":u=f.update(t);break;case"delete":u=f.destroy(t)}u?i.success(u):i.error("Record not found")},n.ajaxSync=n.sync,n.getSyncMethod=function(t){return t.localStorage||t.collection&&t.collection.localStorage?n.localSync:n.ajaxSync},n.sync=function(t,i,r,u){return n.getSyncMethod(i).apply(this,[t,i,r,u])}})();
//@ sourceMappingURL=backbone.localstorage-1.0.min.js.map